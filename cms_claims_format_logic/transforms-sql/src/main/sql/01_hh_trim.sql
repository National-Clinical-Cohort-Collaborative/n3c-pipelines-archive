CREATE TABLE `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/raw/trimmed/hh_trim` AS
  SELECT distinct 
BID,  --replace with n3c id
--hash(concat('djeiu908-',CLAIM_ID)) as pseudo_claim_id,
CLAIM_ID,
FROM_DT,
THRU_DT,
case when PROVIDER='' then '' else hash(PROVIDER+4987652) end as pseudo_provider,
LINECNT,
SGMT_ID,
SGMTLINE,
SGMT_CNT,
SGMT_NUM,
FAC_TYPE,
TYPESRVC,
FREQ_CD,
DISP_CD,
case when AT_NPI='' then '' else hash(AT_NPI+4987652) end as pseudo_AT_NPI,
case when OP_NPI='' then '' else hash(OP_NPI+4987652) end as pseudo_OP_NPI,
case when OT_NPI='' then '' else hash(OT_NPI+4987652) end as pseudo_OT_NPI,
case when R_NPI='' then '' else hash(R_NPI+4987652) end as pseudo_R_NPI,
VISITCNT,
case when RF_NPI='' then '' else hash(RF_NPI+4987652) end as pseudo_RF_NPI,
--SRVC_NPI,
DGNSCD01,
DGNSCD02,
DGNSCD03,
DGNSCD04,
DGNSCD05,
DGNSCD06,
DGNSCD07,
DGNSCD08,
DGNSCD09,
DGNSCD10,
DGNSCD11,
DGNSCD12,
DGNSCD13,
DGNSCD14,
DGNSCD15,
DGNSCD16,
DGNSCD17,
DGNSCD18,
DGNSCD19,
DGNSCD20,
DGNSCD21,
DGNSCD22,
DGNSCD23,
DGNSCD24,
DGNSCD25,
RVCNTR01,
RVCNTR02,
RVCNTR03,
RVCNTR04,
RVCNTR05,
RVCNTR06,
RVCNTR07,
RVCNTR08,
RVCNTR09,
RVCNTR10,
RVCNTR11,
RVCNTR12,
RVCNTR13,
RVCNTR14,
RVCNTR15,
RVCNTR16,
RVCNTR17,
RVCNTR18,
RVCNTR19,
RVCNTR20,
RVCNTR21,
RVCNTR22,
RVCNTR23,
RVCNTR24,
RVCNTR25,
RVCNTR26,
RVCNTR27,
RVCNTR28,
RVCNTR29,
RVCNTR30,
RVCNTR31,
RVCNTR32,
RVCNTR33,
RVCNTR34,
RVCNTR35,
RVCNTR36,
RVCNTR37,
RVCNTR38,
RVCNTR39,
RVCNTR40,
RVCNTR41,
RVCNTR42,
RVCNTR43,
RVCNTR44,
RVCNTR45,
REV_DT01,
REV_DT02,
REV_DT03,
REV_DT04,
REV_DT05,
REV_DT06,
REV_DT07,
REV_DT08,
REV_DT09,
REV_DT10,
REV_DT11,
REV_DT12,
REV_DT13,
REV_DT14,
REV_DT15,
REV_DT16,
REV_DT17,
REV_DT18,
REV_DT19,
REV_DT20,
REV_DT21,
REV_DT22,
REV_DT23,
REV_DT24,
REV_DT25,
REV_DT26,
REV_DT27,
REV_DT28,
REV_DT29,
REV_DT30,
REV_DT31,
REV_DT32,
REV_DT33,
REV_DT34,
REV_DT35,
REV_DT36,
REV_DT37,
REV_DT38,
REV_DT39,
REV_DT40,
REV_DT41,
REV_DT42,
REV_DT43,
REV_DT44,
REV_DT45,
HCPSCD01,
HCPSCD02,
HCPSCD03,
HCPSCD04,
HCPSCD05,
HCPSCD06,
HCPSCD07,
HCPSCD08,
HCPSCD09,
HCPSCD10,
HCPSCD11,
HCPSCD12,
HCPSCD13,
HCPSCD14,
HCPSCD15,
HCPSCD16,
HCPSCD17,
HCPSCD18,
HCPSCD19,
HCPSCD20,
HCPSCD21,
HCPSCD22,
HCPSCD23,
HCPSCD24,
HCPSCD25,
HCPSCD26,
HCPSCD27,
HCPSCD28,
HCPSCD29,
HCPSCD30,
HCPSCD31,
HCPSCD32,
HCPSCD33,
HCPSCD34,
HCPSCD35,
HCPSCD36,
HCPSCD37,
HCPSCD38,
HCPSCD39,
HCPSCD40,
HCPSCD41,
HCPSCD42,
HCPSCD43,
HCPSCD44,
HCPSCD45
FROM `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/CMS Medicare Parsing/transform/02 - schema applied/hh`
order by BID, CLAIM_ID, FROM_DT 