CREATE TABLE `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/raw/trimmed/ip_trim` AS
select
	BID,  --replace with n3c_id
	--hash(concat('djeiu908-',CLAIM_ID)) as pseudo_claim_id,
	CLAIM_ID,
	DRG_CD,
	CLM_TYPE,
	FROM_DT,
	THRU_DT,
	case when PROVIDER='' then '' else hash(PROVIDER+4987652) end as pseudo_provider,
	LINECNT,
    SGMT_ID,
    SGMTLINE,
    SGMT_CNT,
    SGMT_NUM,
	FAC_TYPE,
	TYPESRVC,
	FREQ_CD,
	DISP_CD,
	case when AT_NPI='' then '' else hash(AT_NPI+4987652) end as pseudo_AT_NPI,
	case when OP_NPI='' then '' else hash(OP_NPI+4987652) end as pseudo_OP_NPI,
	case when SRVCFAC='' then '' else hash(SRVCFAC+4987652) end as pseudo_SRVCFAC,
	ADMSN_DT,
	TYPE_ADM,
	SRC_ADMS,
	AD_DGNS,
	PTNTSTUS,
	POANCD01,
	POANCD02,
	POANCD03,
	POANCD04,
	POANCD05,
	POANCD06,
	POANCD07,
	POANCD08,
	POANCD09,	
	POANCD10,
	POANCD11,
	POANCD12,
	POANCD13,
	POANCD14,
	POANCD15,
	POANCD16,
	POANCD17,
	POANCD18,
	POANCD19,
	POANCD20,
	POANCD21,
	POANCD22,
	POANCD23,
	POANCD24,
	POANCD25,
	DGNSCD01,
	DGNSCD02,
	DGNSCD03,
	DGNSCD04,
	DGNSCD05,
	DGNSCD06,
	DGNSCD07,
	DGNSCD08,
	DGNSCD09,
	DGNSCD10,
	DGNSCD11,
	DGNSCD12,
	DGNSCD13,
	DGNSCD14,
	DGNSCD15,
	DGNSCD16,
	DGNSCD17,
	DGNSCD18,
	DGNSCD19,
	DGNSCD20,
	DGNSCD21,
	DGNSCD22,	
	DGNSCD23,
	DGNSCD24,
	DGNSCD25,
	EDGNCD01,
	PRCDRCD01,
	PRCDRCD02,
	PRCDRCD03,
	PRCDRCD04,
	PRCDRCD05,
	PRCDRCD06,
	PRCDRCD07,
	PRCDRCD08,
	PRCDRCD09,
	PRCDRCD10,
	PRCDRCD11,
	PRCDRCD12,
	PRCDRCD13,
	PRCDRCD14,
	PRCDRCD15,
	PRCDRCD16,
	PRCDRCD17,
	PRCDRCD18,
	PRCDRCD19,
	PRCDRCD20,
	PRCDRCD21,
	PRCDRCD22,
	PRCDRCD23,
	PRCDRCD24,
	PRCDRCD25,
	RVCNTR01,
	RVCNTR02,
	RVCNTR03,	
	RVCNTR04,
	RVCNTR05,
	RVCNTR06,
	RVCNTR07,
	RVCNTR08,
	RVCNTR09,
	RVCNTR10,
	RVCNTR11,
	RVCNTR12,
	RVCNTR13,
	RVCNTR14,
	RVCNTR15,
	RVCNTR16,
	RVCNTR17,
	RVCNTR18,
	RVCNTR19,
	RVCNTR20,
	RVCNTR21,
	RVCNTR22,
	RVCNTR23,
	RVCNTR24,
	RVCNTR25,
	RVCNTR26,
	RVCNTR27,
	RVCNTR28,
	RVCNTR29,
	RVCNTR30,
	RVCNTR31,
	RVCNTR32,
	RVCNTR33,
	RVCNTR34,
	RVCNTR35,
	RVCNTR36,
	RVCNTR37,
	RVCNTR38,
	RVCNTR39,
	RVCNTR40,
	RVCNTR41,
	RVCNTR42,
	RVCNTR43,
	RVCNTR44,
	RVCNTR45,
	HCPSCD01,
	HCPSCD02,
	HCPSCD03,
	HCPSCD04,
	HCPSCD05,
	HCPSCD06,
	HCPSCD07,
	HCPSCD08,
	HCPSCD09,
	HCPSCD10,
	HCPSCD11,
	HCPSCD12,
	HCPSCD13,
	HCPSCD14,
	HCPSCD15,
	HCPSCD16,
	HCPSCD17,
	HCPSCD18,
	HCPSCD19,
	HCPSCD20,
	HCPSCD21,
	HCPSCD22,
	HCPSCD23,
	HCPSCD24,
	HCPSCD25,
	HCPSCD26,
	HCPSCD27,
	HCPSCD28,
	HCPSCD29,
	HCPSCD30,
	HCPSCD31,
	HCPSCD32,
	HCPSCD33,
	HCPSCD34,
	HCPSCD35,
	HCPSCD36,
	HCPSCD37,
	HCPSCD38,
	HCPSCD39,
	HCPSCD40,
	HCPSCD41,
	HCPSCD42,
	HCPSCD43,
	HCPSCD44,
	HCPSCD45
 FROM `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/CMS Medicare Parsing/transform/02 - schema applied/ip`
 order by BID, CLAIM_ID, FROM_DT