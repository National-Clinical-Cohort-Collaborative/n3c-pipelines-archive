CREATE TABLE `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/raw/trimmed/opl_trim` AS
   SELECT distinct
BID,  --replace with n3c id
--hash(concat('djeiu908-',CLAIM_ID)) as pseudo_claim_id,
CLAIM_ID,
LINEITEM,
LINECNT,
SGMT_ID,
SGMTLINE,
SGMT_CNT,
SGMT_NUM,
FROM_DT,
THRU_DT,
case when PROVIDER='' then '' else hash(PROVIDER+4987652) end as pseudo_provider,
FAC_TYPE,
TYPESRVC,
FREQ_CD,
PMT_AMT,
case when AT_NPI='' then '' else hash(AT_NPI+4987652) end as pseudo_at_npi,
case when OP_NPI='' then '' else hash(OP_NPI+4987652) end as pseudo_op_npi,
case when OT_NPI='' then '' else hash(OT_NPI+4987652) end as pseudo_ot_npi,
STUS_CD,
case when SRVCFAC='' then '' else hash(SRVCFAC+4987652) end as pseudo_SRVCFAC,
case when R_NPI='' then '' else hash(R_NPI+4987652) end as pseudo_r_npi,
PVISIT01,
PVISIT02,
PVISIT03,
case when RF_NPI='' then '' else hash(RF_NPI+4987652) end as pseudo_rf_npi,
case when SRVCNPI='' then '' else hash(SRVCNPI+4987652) end as pseduo_srvcnpi,
DGNSCD01,
DGNSCD02,
DGNSCD03,
DGNSCD04,
DGNSCD05,
DGNSCD06,
DGNSCD07,
DGNSCD08,
DGNSCD09,
DGNSCD10,
DGNSCD11,
DGNSCD12,
DGNSCD13,
DGNSCD14,
DGNSCD15,
DGNSCD16,
DGNSCD17,
DGNSCD18,
DGNSCD19,
DGNSCD20,
DGNSCD21,
DGNSCD22,
DGNSCD23,
DGNSCD24,
DGNSCD25,
PRCDRD01,
PRCDRD02,
PRCDRD03,
PRCDRD04,
PRCDRD05,
PRCDRD06,
PRCDRD07,
PRCDRD08,
PRCDRD09,
PRCDRD10,
PRCDRD11,
PRCDRD12,
PRCDRD13,
PRCDRD14,
PRCDRD15,
PRCDRD16,
PRCDRD17,
PRCDRD18,
PRCDRD19,
PRCDRD20,
PRCDRD21,
PRCDRD22,
PRCDRD23,
PRCDRD24,
PRCDRD25,
PRCDRCD01,
PRCDRCD02,
PRCDRCD03,
PRCDRCD04,
PRCDRCD05,
PRCDRCD06,
PRCDRCD07,
PRCDRCD08,
PRCDRCD09,
PRCDRCD10,
PRCDRCD11,
PRCDRCD12,
PRCDRCD13,
PRCDRCD14,
PRCDRCD15,
PRCDRCD16,
PRCDRCD17,
PRCDRCD18,
PRCDRCD19,
PRCDRCD20,
PRCDRCD21,
PRCDRCD22,
PRCDRCD23,
PRCDRCD24,
PRCDRCD25,
REV_CNTR,
REV_DT,
HCPCS_CD
FROM `/UNITE/CMS Raw Data Parsing - RWD Pipeline - N3C COVID Replica/CMS Medicare Parsing/transform/02 - schema applied/opl`
order by BID, CLAIM_ID, FROM_DT 